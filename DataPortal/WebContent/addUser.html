<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>User</title>
<link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.0.3/css/bootstrap.min.css">
<link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.0.3/css/bootstrap-theme.min.css">
<script type="text/javascript" src="http://code.jquery.com/jquery.min.js"></script>
<script src="http://netdna.bootstrapcdn.com/bootstrap/3.0.3/js/bootstrap.min.js"></script>
<script>
	function doSubmit(){
		
		var un = document.getElementById("userName").value;
		var pw = document.getElementById("password").value;
		var role = document.getElementById("role").value;
		
		document.getElementById("successStatus").style.display = "none";
		document.getElementById("failureStatus").style.display = "none";
		document.getElementById("defaultStatus").style.display = "none";
	
		if(un != "" && un != null && pw != "" && pw != null) {
				var xmlhttp;
				if (window.XMLHttpRequest) {
					xmlhttp = new XMLHttpRequest();
				} else {
					xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
				}
				xmlhttp.onreadystatechange = function() {
					if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {			
						var showdata = xmlhttp.responseText;
						var json = jQuery.parseJSON(showdata);
						var status = json["STATUS"];
						 if(status){
							 document.getElementById("successStatus").style.display = "block";
							 document.getElementById("failureStatus").style.display = "none";
							 document.getElementById("defaultStatus").style.display = "none";
							 document.getElementById("userName").value = "";
							 document.getElementById("password").value = "";
							 document.getElementById("role").value = "";
						 } else {
							 document.getElementById("successStatus").style.display = "none";
							 document.getElementById("failureStatus").style.display = "block";
							 document.getElementById("defaultStatus").style.display = "none";
						 }
					} // end of if condition
				}
				var params = "userName="+encodeURIComponent(un)+"&password="+encodeURIComponent(pw)+"&role="+encodeURIComponent(role);
				xmlhttp.open("POST", "http://localhost:8080/WebTMonService/login/LoginService/addUser", true); 
				xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
				xmlhttp.send(params);
		} else {
			if( (un == null || un == "")  && (pw == "" || pw == null)) {
				document.getElementById("defaultStatus").style.display = "block";
				document.getElementById("defaultStatus").className = "alert alert-warning";
				document.getElementById("defaultContent").innerHTML = "<span class='glyphicon glyphicon-hand-right' style='float: left;'></span><strong>Warning!</strong> &nbsp;&nbsp;Please enter user name and password";	
				document.getElementById("userName").focus();	
			} else if( un == null || un == "" ) {
				document.getElementById("defaultStatus").style.display = "block";
				document.getElementById("defaultStatus").className = "alert alert-warning";
				document.getElementById("defaultContent").innerHTML = "<span class='glyphicon glyphicon-hand-right' style='float: left;'></span><strong>Warning!</strong> &nbsp;&nbsp;Please enter user name";	
				document.getElementById("userName").focus();
			} else if( pw == null || pw == "" ) {
				document.getElementById("defaultStatus").style.display = "block";
				document.getElementById("defaultStatus").className = "alert alert-warning";
				document.getElementById("defaultContent").innerHTML = "<span class='glyphicon glyphicon-hand-right' style='float: left;'></span><strong>Warning!</strong> &nbsp;&nbsp;Please enter password";	
				document.getElementById("password").focus();
			}
		}	
	}

	function getApplications() {
		
		var xmlhttp;
		if (window.XMLHttpRequest) {
			xmlhttp = new XMLHttpRequest();
		} else {
			xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
		}
	
		xmlhttp.onreadystatechange = function() {
			if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {			
				var showdata = xmlhttp.responseText;
				var applications = jQuery.parseJSON(showdata);
				var size = applications.AppDetails.length;
				
				var main = document.getElementById('role');
				for(i=0; i<size; i++) {
					var optionNodeName = document.createElement("option");
					optionNodeName.text = applications.AppDetails[i].appName;
					optionNodeName.value = applications.AppDetails[i].appId;
					main.appendChild(optionNodeName);
				}
				
			} // end of if condition
		}
		xmlhttp.open("GET", "http://localhost:8080/WebTMonService/store/StoreService/getApplications", true); 
		xmlhttp.send();
	}

</script>
</head>
<body style="background-color: rgb(228, 229, 231); font-size: 19px; color: #123">
	<div class="panel panel-default">
  		<div class="panel-heading">
    		<span class="glyphicon glyphicon-user" style="float: right;"></span><h3 class="panel-title">Adding User</h3>
  		</div>
  		<div class="panel-body" style="padding: 54px 30px;">
			<div class="container" style="padding-bottom: 23px;">        
		        <div id="AddUser" style="padding-top: 40px; padding-left: 75px">
			        <div class="input-group" style="width: 40%;">
			  			<input type="text" class="form-control" id="userName" name="userName" placeholder="Enter User Name" style="border-radius: 4px;">
					</div><br>
			        <div class="input-group" style="width: 40%;">
			  			<input type="password" class="form-control" id="password" name="password" placeholder="Enter Password" style="border-radius: 4px;">
					</div><br>
			        <div class="input-group" style="width: 40%;">
			  			<select class="form-control" id="role" name="role" style="border-radius: 4px;">
			  				<option value="ADMIN">ADMIN</option>
			  			</select>
					</div><br>
					<button type="button" class="btn btn-primary navbar-btn" id="Add" onclick="doSubmit()">Add</button>
				</div>
			</div>
			<div id="defaultStatus" style="display: block; font-size: 14px; padding: 4px; margin-bottom: 0px;">
      			<div id="defaultContent" style="margin-left: 15px; text-align: center;">&nbsp;</div>
    		</div>
			<div id="successStatus" class="alert alert-success" style="display: none; font-size: 14px; padding: 4px; margin-bottom: 0px;">
      			<div style="margin-left: 15px; text-align: center;"><span class="glyphicon glyphicon-hand-right" style="float: left;"></span><strong>Well done!</strong> &nbsp;&nbsp; You have added user successfully.</div>
    		</div>
			<div id="failureStatus" class="alert alert-danger" style="display: none; font-size: 14px; padding: 4px; margin-bottom: 0px;">
      			<div style="margin-left: 15px; text-align: center;"><span class="glyphicon glyphicon-hand-right" style="float: left;"></span><strong>Oh snap!</strong> &nbsp;&nbsp; Change a few things up and try submitting again.</div>
    		</div>
  		</div>
	</div>
  	<script>getApplications();</script>
</body>
</html>                                		